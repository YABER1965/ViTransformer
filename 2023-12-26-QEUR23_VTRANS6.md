---
title: QEUR23_VTRANS6: 閑話休題～なぜ、いま外観検査自動機か！？
date: 2023-12-26
tags: ["QEUシステム", "メトリックス", "Python言語", "Vision Transformer", "LLM", "データセット", "Fine-tuning", "イノベーション"]
excerpt: Vision Transformer(ViT)をやってみる
---

## QEUR23_VTRANS6: 閑話休題～なぜ、いま外観検査自動機か！？

## ～ （検査は）誰でも、気軽にやれれば良いと思います ～

### ・・・ 前回のつづきです ・・・

D先生 ： “なるほど・・・。FOUNDERは、RT法を改造してアテンション・マップを作成するプロジェクトをあきらめたんですか？”

![imageJRL8-7-1](/2023-12-26-QEUR23_VTRANS6/imageJRL8-7-1.jpg)

QEU:FOUNDER ： “まだ、（RT法の発展を）あきらめてはいないよ。ただし、それを極めていくとRT法からどんどん外れることがわかっていますよ。今回の、ViTのプロジェクトは「解決のためのヒント」を得るためのものでもあるんです。”

C部長 : “そういう意味でも、ViTのプロジェクトを是非成功させてください！！”

QEU:FOUNDER ： “べつに（自動検査機）専門のベンダーに任せなくても、誰もが簡単に立ち上げて・使える外観検査機を開発することが小生の夢でもあります。ちょっと、ここで小生がなぜ外観検査自動機にこだわるのかについてまとめてみましょう。さて、モダンな外観検査自動機は、だいたい以下のように分類できるでしょう。”

- **画像差分を使う方法(※)**
- **当てはめ（教師あり学習）を使う方法**
- **距離を使う方法**
- **VAE（オートエンコーダ）を使う方法（※）**

D先生 ： “外観検査自動機と言えば、いまでも画像差分法（↓）が主流なのでしょうね。そして、自動機が普及しないのも、画像差分のもつ特性のため・・・。”

![imageJRL8-7-2](/2023-12-26-QEUR23_VTRANS6/imageJRL8-7-2.jpg)

QEU:FOUNDER ： “画像差分法は、製品（と検査画像）に高度の転写性があることが前提条件になるからね。だからPCB（プリント基板）にはうまく適用できる。・・・でも、同じく転写性が比較的高い射出成型品の検査となると・・・、どうかなぁ・・・。どうです？現場の働くC部長の意見は・・・？”

C部長 : “射出成型品の検査に画像差分法を使うのは、もはや（画像差分法の）有効性がアヤシイでしょう。成形品は意外と製品の歪が大きいし、なにしろ画像差分法は立体の物体に対して、あまり得意じゃないですよね。”

D先生 ： “あの・・・。VAE（オートエンコーダ―）というのは、どんな方法ですか？”

![imageJRL8-7-3](/2023-12-26-QEUR23_VTRANS6/imageJRL8-7-3.jpg)

QEU:FOUNDER ： “こんな（↑）方法です。”

C部長 : “よくわかりません。”

[![MOVIE1](http://img.youtube.com/vi/DuN8K3J7HyY/0.jpg)](http://www.youtube.com/watch?v=DuN8K3J7HyY "[4K 60FPS] 나카모리 아키나(中森明菜) - 슬로우모션(スローモーション) 1982 4K AI Upscaling")

QEU:FOUNDER  ： “じゃあ、出来栄えをみてみましょう。コレ・・・（↑）。”

D先生 ： “う～ん・・・。やはり、「素材（明菜）」がよいと4Kは見ごたえがあるのお・・・・。・・・というのは冗談、1982年の美少女の画像が4Kで鑑賞可能になっているというのが見どころですね。”

QEU:FOUNDER ： “つまり、オートエンコーダ―による欠陥検出というのは、**欠陥品の画像をオートエンコーダで無理やり良品画像に転換**し、その後に良品画像と不良品画像を比較するという方法です。・・・だけどね、思うの・・・。「そんなにうまく行くのかな？」って・・・。”

D先生 ： “さっきの検査法のリストで「星印（※）」を付けた意味が分かりました。「両方とも画像差分法でしょ？」ということですね。うまく行くかどうかは、なんともはや・・・。あとは、画像差分のあとでも、不良判定が必要になりますよね。そうすると、そこで、判定段階で「当てはめ」か「距離」を使って判定する必要があります。”

![imageJRL8-7-4](/2023-12-26-QEUR23_VTRANS6/imageJRL8-7-4.jpg)

QEU:FOUNDER  ： “いまどき外観検査で「距離」を使って判定するケースは非常に少ないと思うよ。まずは、ほとんどの検査の場合には当てはめるべき関数が非常に複雑である（マハラノビス関数では当てはめられない）こと。さらには、一般的に検査は多くの単位空間を持っていること・・・。”

C部長 : “以前、FOUNDERが単純なコネクタ端子抜け検査のロジックを作ったときにも、単位空間が3つも必要でしたよね。”

D先生 ： “あれはFeasibility Studyのための「お遊び」です。現実に実用に耐えられるようにするには、はるかに多くの単位空間が必要になるでしょう。・・・であるなら、面倒くさいので「当てはめ」で異常（不良）判定をしますよね。その当てはめの手法が「単純なディープラーニング」か、「ＣＮＮ」か、それとも「ViT」になるのかはさておき・・・。”

![imageJRL8-7-5](/2023-12-26-QEUR23_VTRANS6/imageJRL8-7-5.jpg)

QEU:FOUNDER  ： “このように考えると、小生が外観検査のためにViTのシーズを使いたいという意味がわかるでしょう。・・・でもね、転写がとても難しい製品（例えば↓）というのはしょうがないとして、転写性がかなり高い成形品では、**もうちょっと工夫して楽したい**と思わない？”

![imageJRL8-7-6](/2023-12-26-QEUR23_VTRANS6/imageJRL8-7-6.jpg)

D先生 ： “だから、RTメトリックスとAttentionを組み合わせて簡単にアテンションマップを作ってみたいということですね。”

QEU:FOUNDER  ： “今回は閑話休題として小生の検査の見方を2点だけ説明しました。すなわち、なぜ小生が**ViTによる検査機の開発をしているのか**、さらには**RT法による検査法に対して、まだ「少しだけ」こだわっているのか**・・・。ちなみに、本件、誰かが先にやってくれても一向にかまいません。これは世のため、人のため・・・。”


### ～ まとめ ～

C部長 : “今までの議論でよくわかりました。品質と検査は本当に大切ですね。”

![imageJRL8-7-7](/2023-12-26-QEUR23_VTRANS6/imageJRL8-7-7.jpg)

QEU:FOUNDER ： “ん！？確かに検査は大切だよ。でもね、**品質って「百害」しかない**んじゃないの？”

### [検査の目的は不良発見のときの利益である]

検査方法が決まっているとき、検査するかしないかは工程から出てくる製品の品質水準のいかんによる。品質水準が悪ければ検査をしたほうが良いし、品質水準がわるくなければ**無検査が望ましい**。
検査の目的はどこにあるのだろうか。それは不良品を発見したときに、利益が生まれるのである。（中略）したがって、検査の研究とは、安くて確実な検査方法を開発すること。開発した検査方法の経済的価値を計算し、検査工程を設置すべきかどうかを決めること。
（出典は敢えて言いません）

QEU:FOUNDER ： “とある昭和のおじさん（↑）が、「ふわふわと」適当なことをいってますな・・・。くだらん・・・。**ム（無）検査なんかはあり得ない**んですよ。”

C部長 : “OMG(Oh My God)！？元信者のFOUNDERから、このセリフを聞くとは！！”

![imageJRL8-7-8](/2023-12-26-QEUR23_VTRANS6/imageJRL8-7-8.jpg)

QEU:FOUNDER  ： “もともと、小生は「信者」だった時代から、このコメント（↑[検査の目的は不良発見のときの利益である）は間違いだと思っていました。品質の本当の問題は、お客さんの不利益じゃないんですよ。これは、小生がGEU（Quality Engineering Unity）のプロジェクトを立ち上げてからの一貫とした考え方です。”

C部長 : “（ボクは耳からタコが出てくるほど聞いてますが・・・、）ほう？それは何です？”

![imageJRL8-7-9](/2023-12-26-QEUR23_VTRANS6/imageJRL8-7-9.jpg)

D先生 ： “品質の本当の問題は、品質によって企業文化、しいては社会の在り方が変質し、それがもとで**人々が「圧倒的な」不利益を被る**ことです。ん？説明がわかりにくい？では、さらなる補足はFOUNDERにつづく・・・。”

### オッサン：従業員の皆さんにはテレビを見てください。皆が同じように考えてください。
### オッサン：“検査不正”っていうのはなァ、（組織外に不正を）漏らしたヤツが悪いんだよ。
### オッサン：私の使命はこの会社で終身雇用制を実現することにある。(この言葉をわざわざ海外の会社で言っている)

QEU:FOUNDER ： “最も深刻な問題は**「最適化」**ですよ。企業と社会の・・・。**たかが「品質」のために、なぜこれほど社会と企業をギスギスさせる必要があるんだ！？**検査が100％しっかりすれば、**不良の問題は（企業）内部コストの問題**にしかすぎません。昭和のオッサンのように、製造に携わる人々が過度に緊張して「無検査」を維持することなんかは、人間としてあり得ないんです。もちろん、いわゆる特殊特性（検査できない特例）という例外はあるがね。”

C部長 : “たかが高品質（無検査）を実現させるために、どれだけ、そこで働く人間に負担をかけるねん！！・・・ということ？”

![imageJRL8-7-10](/2023-12-26-QEUR23_VTRANS6/imageJRL8-7-10.jpg)

D先生 ： “もちろん。さらにいうと、検査の自動化が実現すると、**「お客」が自動検査機をつくってサプライヤに渡す**ことが最もいいんです。そうすれば、品質保証のシステム（↑）が全く変わってくるんです。”

QEU:FOUNDER ： “いわゆる**「リリース」**というやつです。リリースが変わると、システムの本質が変わる。ISO9001なんかもういらない。TQMなんか百害あって一利もない。TQMって、小生に言わせるとコレ（↓）と同じ・・・。”

[![MOVIE2](http://img.youtube.com/vi/otOwbofeenc/0.jpg)](http://www.youtube.com/watch?v=otOwbofeenc "【狂気】宝塚自●事件。史上最悪の宝塚記者会見から･･･更なる狂気の行動。宝塚の事件からわかる、あなたの人生を蝕むハラスメントの本質を解説する。安冨歩東大教授")

D先生 ： “年末にキレにキレているFOUNDERでした・・・。”

