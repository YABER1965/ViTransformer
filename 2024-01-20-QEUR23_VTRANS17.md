---
title: QEUR23_VTRANS17:  [PyTorch]ViTによる学習（異常検出用）。。。あれ？
date: 2024-01-20
tags: ["QEUシステム", "メトリックス", "Python言語", "Vision Transformer", "LLM", "データセット", "Fine-tuning", "イノベーション"]
excerpt: Vision Transformer(ViT)をやってみる
---

## QEUR23_VTRANS17:  [PyTorch]ViTによる学習（異常検出用）。。。あれ？

## ～ 異常検出の学習は、なかなかに難しい ～

B係長 ： “今回はいよいよViTへの学習段階ですね。「成功」するかな？この**合成画像による画像認識**に・・・。”

![imageJRL8-18-1](/2024-01-20-QEUR23_VTRANS17/imageJRL8-18-1.jpg)

A係長 : “ん？Bさんのいう「成功」ってなに？そもそも、学習のためのデータ数自体が2000件もないからね。もうちょっと多くしておけばよかったと思わない？”

B係長 ： “テスト段階として、これぐらいの数が「最初としてはちょうどいい」って、FOUNDERが言ってたんで・・・。さて、Validation用のデータ設計を考えてみた・・・。”

**（データ水準）**

![imageJRL8-18-2](/2024-01-20-QEUR23_VTRANS17/imageJRL8-18-2.jpg)

**（対象ピンの配置）**

![imageJRL8-18-3](/2024-01-20-QEUR23_VTRANS17/imageJRL8-18-3.jpg)

B係長 ： “ピン配置図において、黄色が学習用データで使用した異常ピンです。そして、赤い太数字のピンが検証で使っている異常ピンです。”

A係長 ： “つまり、**検証ピンと学習ピンを微妙にずらした**わけですね。この程度のズレならば、賢い（？）ViT君がうまく気を回してくれるだろうと・・・。それでは学習結果をドン・・・。プログラムは以前と全く同じですので紹介はしません。結果だけ・・・。”

![imageJRL8-18-4](/2024-01-20-QEUR23_VTRANS17/imageJRL8-18-4.jpg)

B係長 : “あれ・・・？学習はしているのだか、**ACCURACY（予測精度）が全然動かない**。なんなんだ？これ・・・。”

A係長 ： “じゃあ、このモデルを使ってむりやり予測してみるよ。ドン・・・。”

![imageJRL8-18-5](/2024-01-20-QEUR23_VTRANS17/imageJRL8-18-5.jpg)

B係長： “logitって「予測結果」で、labelが「実際のラベル値」でしょ？ちがった？”

A係長 : “そうだよ。どのラベル値のデータでも、その予測結果が0となっているという・・・。ラベル値のリストは以下のように割り当てられています。”

```python
classes = ('BENDNG', 'NUKENG', 'OK')
```

B係長 : “全てが「端子曲がり異常」と認識されているって？”

A係長 ： “要するに、ViTは**「全然学習されていない」**ということじゃない？・・・で、Ｂさん・・・。リベンジで学習するデータの量をもっと増やしてくださいよ。”

B係長 ： “じゃあ、学習も検証も700件程度追加しました。さらに、学習と検証のデータ量も全ピンの情報をカバーするようにしました。これでどう？“

A係長： “OKです。これを使って、再学習した結果をドン・・・。”

![imageJRL8-18-6](/2024-01-20-QEUR23_VTRANS17/imageJRL8-18-6.jpg)

B係長 : “う～ん・・・。あいかわらずACCURACYの量が動かないなぁ・・・。いや・・・。ちょっとだけ動いたか。多分、むりやり予測した結果もおなじ感じでしょ？”

![imageJRL8-18-7](/2024-01-20-QEUR23_VTRANS17/imageJRL8-18-7.jpg)

A係長 ： “まあ、結果も僕たちの予測通りだわ・・・。Bさんねぇ・・・。どうしよう？さらにデータを増やす？”

B係長 ： “まあ、学習データを増やすことは増やすけど、ちょっとそれだけでは「芸」がないなぁ・・・。いまからFOUNDERと相談にいくわ・・・。 “


・・・ B係長はQEU：FOUNDERと相談中 ・・・

QEU:FOUNDER : “あれ？Bさん、来たの？・・・（中略）・・・。そういう結果なら学習データを増やすしかないけど・・・。ただし、「データの増やし方」って、いろいろやり方がある。コレ（↓）を覚えてる？”

![imageJRL8-18-8](/2024-01-20-QEUR23_VTRANS17/imageJRL8-18-8.jpg)

QEU:FOUNDER : “花の画像認識のときには、学習データには花の写真とイラストが混在していましたね。。”

B係長 ： “FOUNDER・・・。今回の異常検出では合成画像を使っていますが・・・。”

・・・ 以上、相談おわり ・・・

B係長 ： “どういう意味なんだろう？“

A係長： “FOUNDERも、さすがに「もう、いい年」だし、思いついたことを適当に言ったんじゃない？週末は遊びにいって、考えを整理して、また挑戦しましょう。次もViT学習のつづきです。”

### [＞寄付のお願い(click here)＜](https://www.paypal.com/paypalme/QEUglobal?v=1&utm_source=unp&utm_medium=email&utm_campaign=RT000481&utm_unptid=29844400-7613-11ec-ac72-3cfdfef0498d&ppid=RT000481&cnac=HK&rsta=en_GB%28en-HK%29&cust=5QPFDMW9B2T7Q&unptid=29844400-7613-11ec-ac72-3cfdfef0498d&calc=f860991d89600&unp_tpcid=ppme-social-business-profile-creat-ed&page=main%3Aemail%3ART000481&pgrp=main%3Aemail&e=cl&mchn=em&s=ci&mail=sys&appVersion=1.71.0&xt=104038)

B係長  ： “是非カンパください・・・。”


## ～ まとめ ～

QEU:FOUNDER ： “いやいや・・・。いろいろと「終わってきている」な・・・。”

[![MOVIE1](http://img.youtube.com/vi/8l4btrL5R5M/0.jpg)](http://www.youtube.com/watch?v=8l4btrL5R5M "衝撃！ダイハツの不正が起きた原因。なぜこんな手の込んだ無意味な不正が起きるのか？これから同様の告発の雪崩が起きる。日本社会の表裏一体の強さと弱さ。")

QEU:FOUNDER ： “**平成の総括**が、ドバァ～っとでてきました。 “

- **オッサン： 従業員の皆さんにはテレビを見てください。皆が同じように考えてください。**
- **オッサン：“検査不正”っていうのはなァ、（組織外に不正を）漏らしたヤツが悪いんだよ。**
- **オッサン：私の使命はこの会社で終身雇用制を実現することにある。(201X年代、わざわざ海外の会社でこれを言うか？ご立派過ぎる！)**

C部長 : “確かに、古い考え方（↓）を変える必要がありますね。もう現場が持たない。”

![imageJRL8-18-9](/2024-01-20-QEUR23_VTRANS17/imageJRL8-18-9.jpg)

QEU:FOUNDER ： “あの会社がわるいんじゃないんだよね。実際は・・・。”

[![MOVIE2](http://img.youtube.com/vi/pNZLSiCqCa4/0.jpg)](http://www.youtube.com/watch?v=pNZLSiCqCa4 "志賀原発をめぐる、ザ・日本的な行政 なぜ支援の人手を拒むのか")

D先生 ： “J国全体と覆う、**「しくみの問題」**です。 “
