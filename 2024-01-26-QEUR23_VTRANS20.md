---
title: QEUR23_VTRANS20:  ViTモデルを角形端子データで学習する（前回からつづく）
date: 2024-01-26
tags: ["QEUシステム", "メトリックス", "Python言語", "Vision Transformer", "LLM", "データセット", "Fine-tuning", "イノベーション"]
excerpt: Vision Transformer(ViT)をやってみる
---

## QEUR23_VTRANS20:  ViTモデルを角形端子データで学習する（前回からつづく）

## ～ 当たり前だが、前よりも良くなった ～

A係長 : “それでは、前回にて準備した角形端子のコネクタのデータを使ってViT学習をしていきましょう。”

![imageJRL8-21-1](/2024-01-26-QEUR23_VTRANS20/imageJRL8-21-1.jpg)

B係長 ： “その学習の後で、アテンション・マップを生成して、前回と比較します。前回のトライアルでは、「そこそこ」の結果でした。”

**（端子円形のみ、アテンション・マップ）**

![imageJRL8-21-2](/2024-01-26-QEUR23_VTRANS20/imageJRL8-21-2.jpg)

B係長 ： “僕、いましがた「そこそこ」って言ったけど、どういう意味だろう・・・（笑）？Aさん、ボクの心の声を解説してくれない？”

A係長 : “まったぁ・・・、もう訳の分からん事を・・・。普段のBさんらしくないですね。う～ん、そうだなぁ・・・。欠陥位置のずれは、まだ予測が不正確なので当然ありうるでしょう。あとは、マップ上のハイライト部の数がやけに多いのが気になる。そもそも、欠陥（端子抜け）は一か所なのに・・・。”

B係長 ： “Aさん、ありがと・・・。じゃあ、ViTモデルの学習をはじめましょう。プログラムはすでに紹介したので、ここでは結果の紹介のみです。ますは、学習の最初の段階から、ドン！！”

![imageJRL8-21-3](/2024-01-26-QEUR23_VTRANS20/imageJRL8-21-3.jpg)

A係長 : “おどろいた・・・。円柱コネクタのみのデータを学習した前回のトライアルでは、300エポック以上も学習してからAccuracyの値に変化があったものだが・・・。”

B係長 ： “角柱の追加で情報量が多くなり、モデルが深く考えなくてもポイントをつかめるようになったんでしょうね。「一目瞭然」とはこのこと・・・（笑）。じゃあ、もうすこし学習を進めてみます。”

![imageJRL8-21-4](/2024-01-26-QEUR23_VTRANS20/imageJRL8-21-4.jpg)

A係長 ： “うん。ここまで進むと順調に学習されてる・・・。でも、もうそろそろ「（精度の向上も）限界かな？」とも思います。**実力は86%程度ぐらい**かな・・・。”

B係長 : “じゃあ、もうそろそろお待ちかねのアテンション・マップを見てみましょう。”

![imageJRL8-21-5](/2024-01-26-QEUR23_VTRANS20/imageJRL8-21-5.jpg)

A係長 ： “うん。出来が、かなり良くなってる。かなり、（ポイントが）しぼられてきたなぁ・・・。でも、時折、なぜコネクタの上のアテンション量が高くなるんだろうか？”

B係長： “今回、端子の形を変えたデータを学習させると、パフォーマンスが上がってきたのと同じでしょ？複数の違った形の端子のデータを学習して、初めて、ViTさんは端子抜けの異常が端子の形に依存しないということがわかるんです。”

A係長 : “・・・ということは、**違った形のコネクタを学習して、初めてコネクタと端子抜けが関係ないことがわかる**の？”

B係長 : “そうだと思うよ・・・。”

A係長 ： “じゃあ、次はコネクタを変えてみましょう！”

B係長 ： “残念・・・。FOUNDERから、是非やって欲しいと言われているデータ学習があるので、それが終わってからやりましょう。どう？これで、プロジェクトがますます面白くなったでしょう？”

### [＞寄付のお願い(click here)＜](https://www.paypal.com/paypalme/QEUglobal?v=1&utm_source=unp&utm_medium=email&utm_campaign=RT000481&utm_unptid=29844400-7613-11ec-ac72-3cfdfef0498d&ppid=RT000481&cnac=HK&rsta=en_GB%28en-HK%29&cust=5QPFDMW9B2T7Q&unptid=29844400-7613-11ec-ac72-3cfdfef0498d&calc=f860991d89600&unp_tpcid=ppme-social-business-profile-creat-ed&page=main%3Aemail%3ART000481&pgrp=main%3Aemail&e=cl&mchn=em&s=ci&mail=sys&appVersion=1.71.0&xt=104038)

A係長  ： “このプロジェクトを通じて、**かなり「すごいモノができる」ことが予感できます**。”

## ～ まとめ ～

### ・・・ 前回のつづきです ・・・

C部長 : “そんなに、ViTって「頭がいい」のかな？”

QEU:FOUNDER ： “(ViTは)頭がすごくいいと思うよ。我々（人類）よりも比べ物にならないくらい。今は、学習するデータが足らないだけです。”

D先生 ： “（学習データの）質と量を含めてね・・・。ただし、**SOART3による合成画像の生成ロジックは、外観検査の使い勝手を劇的に改善させる**はずです。“

![imageJRL8-21-6](/2024-01-26-QEUR23_VTRANS20/imageJRL8-21-6.jpg)

QEU:FOUNDER ： “合成画像は、標準ベクトルと計測ベクトルの差異から計算されています。ここでC部長に質問です。BlenderなどのVRのデータから生成した合成画像と、現場の画像から生成した合成画像は何が違うの？”

C部長 : “えっ？・・・そうねえ？結局は同じじゃないんですかねえ、**外観検査の「ポイント」を外さない**限り・・・。”

![imageJRL8-21-7](/2024-01-26-QEUR23_VTRANS20/imageJRL8-21-7.jpg)

QEU:FOUNDER ： “つまり、我々がやっている「SOART3-ViT」の仕組みを使えば、**①多くのデータが必要なプリ・トレーニング段階はVRデータ**で行い、**②そのシステムを現場で使うときに、少量の現場のデータを使ってファイン・チューニングで学習する**ことができます。こんな方法が、今までの外観検査の中で、他にあるの？”

[![MOVIE1](http://img.youtube.com/vi/tAev_CGqgVs/0.jpg)](http://www.youtube.com/watch?v=tAev_CGqgVs "ディープラーニングによる異常検知（Anomaly Detection）")

D先生 ： “あ～あ、いやなことを思い出した・・・。昔、私は「外観検査は、正常データしか使わない手法が最も使いやすい」と思っていたんです。“

![imageJRL8-21-8](/2024-01-26-QEUR23_VTRANS20/imageJRL8-21-8.jpg)

QEU:FOUNDER ： “**距離計測を代表とする「正解データ」を使う検査（検出）手法って最悪だよ。**立ち上げ時は、比較的少ないデータで立ち上がるので便利に見えるだけです。しかし、**（検査機が）立ち上がったあとの「伸びしろ」がない**んです。理由は２つ、「単位空間（距離の原点）」と「閾値の設定」です。”

C部長 : “さらにいうと、距離計測を使う手法って、**モデル内に「ノウハウが積みあがらない」**のです。結局、流出不良の事故が起こった場合、改善すればするほとシステムが複雑になり、ユーザーの手間がかかります。”

[![MOVIE2](http://img.youtube.com/vi/RZRnXkDmhyk/0.jpg)](http://www.youtube.com/watch?v=RZRnXkDmhyk "李鳳山師父平甩教學30min")

QEU:FOUNDER ： “簡単な方法が一番いいんです。我々の方法は難しく見えるかもしれません。でも、一度システムが出来上がれば驚くほど簡単です。適切なモデルが、一度、出来上がれば、**「お手手をブラブラするだけ（↑）」**で成果が上がってきますよ。 “

C部長 : “あれ？このカンフーを見たときがないですね。”

QEU:FOUNDER ： “TW発祥の、もっともシンプルなカンフーです。発案者は、**「近年の人間は複雑なことをし過ぎるから生命力が落ちてしまっている。私は、簡単な健康増進法を提案して人々の生命力を上げたい。」**と言ったんです。SOART3-ViTのコンセプトは、このカンフーと同じですよ。”

D先生 ： “このカンフーがJ国に100％普及したらどうなるでしょうか？ “

QEU:FOUNDER ： “**J国のGDPが少なくとも1％上がります。** “

